<html>
  <head>
  <meta charset='utf-8'/>
    <title>Farsi Word Cloud</title>
    <script src="d3.js" charset="utf-8"></script>
    <script src="d3.layout.cloud.js"></script>
    <script src="d3.wordcloud.js"></script>
    <script src="example.words.js"></script>
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lalezar">
  </head>
  <body style="text-align: center; font-family:'Lalezar'">

    <div id='wordcloud'></div>

    <script charset='utf-8'>


    var pattern = /[آ-ی]+/g,

    string ="پروژه‌ی «به روایت داده‌های تهران» تمرکز این پروژه بر ایجاد رویکرد طراحانه‌ در روند جمع‌آوری  و مصور‌سازی  داده‌هایی است که در شهر وجود دارند و یا اساسا به واسطه‌ی این پروژه بوجود می آیند. منظور از «داده‌ها»‌ در این پروژه داده‌هایی است که ظرفیت‌های روایی قابل توجه و رابطه‌ی مستقیمی با شهروندان، نظرات و باورهای آن‌ها دارند. در این پروژه طراح در عین حال که به روش‌ها رایانشی و فرآیند‌های دیجیتال جمع‌آوری و مصورسازی داده می پردازد، ردپایی از شخصیت طراحانه‌ی خود را نیز در فرآیند و محصول این فعالیت منطقی و مستدل باقی می‌گذارد و برخلاف رویه‌ی معمول طراح/پژوهشگر واهمه ای از «تحت تاثیر قرار دادن داده ها ندارد». این پروژه با محوریت قرار دادن روند انبوه‌سپاری  اقدام به برگزاری زنجیره ای از کارگاه‌ها می‌کند تا در نهایت یک پایگاه داده، که در دسترس عموم قرار خواهد گرفت تولید شود. این پایگاه متشکل از داده‌های مصور‌شده و روایت-محور است که بر خلاف روند معمول، طراحان آن‌ها را تولید و از آن‌ها استفاده خواهند کرد. معرفی کارگاه اول از سری کارگاه‌های به روایت داده‌های تهران: دغدغه‌ها  در این کارگاه شرکت‌‌کنندگان در ابتدا با شیوه‌های نوین و نسبتا خلاف-آمد-انتظارِ جمع‌آوری داده‌های شهری آشنا خواهند شد و پس از پرورش ایده‌های اولیه خود با توجه به محوریت موضوعی این کارگاه (دغدغه‌ها) به جمع‌آوری داده‌های مورد نظرشان اقدام می‌کنند. روش‌های گردآوری داده‌ای که این کارگاه، شرکت‌کنندگان را با آن‌ها آشنا می‌کند شامل شیوه‌های میدانی  و شیوه‌های‌ رایانشی  مبتنی بر داده‌های موجود در شبکه‌ی جهانی وب می باشد. سپس شرکت‌کنندگان با استفاده از روش‌های متناسب با نوع داده‌های مد نظرشان، آن‌ها را در قالب صفحات وب در پایگاه داده www.tehran-now.ir/data بارگزاری می کنند. مخاطبین کارگاه:  دانشجویان و فارغ التحصیلان رشته‌های شهرسازی، طراحی‌شهری، معماری و سایر علاقه مندان به موضوعات مرتبط با کارگاه این کارگاه مناسب چه کسانی نیست: - اگر تاکنون داده‌هایی را با استفاده از یکی از «رابط‌های برنامه نویسی کاربردی»  موجود جمع‌آوری و یا مصور کرده‌اید. - اگر تاکنون با استفاده از رابط‌های برنامه نویسی کاربردی موجود از شبکه‌های اجتماعی یا وب‌سایت‌های خبری، داده‌هایی را جمع‌آوری و یا مصور کرده‌اید. -اگر تاکنون با استفاده از روش‌های میدانی داده‌هایی را جمع‌آوری و آن‌ها را بر روی صفحه‌های وب مصور کرده‌اید. مطالبی که در این کارگاه با آن‌ها آشنا می شوید: نظری: برنامه‌ی زمانی کارگاه: * این جلسه با توجه به ایده‌ها و روش‌های مد نظر هر یک از گروه‌ها به تفکیک میدانی یا رایانشی به صورت توافقی و در طول تاریخ ذکر‌شده برگزار خواهد شد. هر یک از مدرسین دوره نیز مسئولیت هدایت گروه‌های جمع‌آوری میدانی و یا رایانشی در محل کارگاه را بر عهده خواهند داشت. توضیحات بیشتر و هماهنگی برگزاری این جلسه در پایان جلسه‌ی سوم انجام خواهد شد. ** ساعت برگزاری این جلسه و لیست منتقدین متعاقبا اعلام می‌شود. "
        matchedWords = string.match( pattern );

    // The Array.prototype.reduce method assists us in producing a single value from an
      // array. In this case, we're going to use it to output an object with results.

    var counts = matchedWords.reduce(function ( stats, word ) {

         //`stats` is the object that we'll be building up over time.
          // `word` is each individual entry in the `matchedWords` array
        if ( stats.hasOwnProperty( word ) ) {
            // `stats` already has an entry for the current `word`.
            //   As a result, let's increment the count for that `word`.
            stats[ word ] = stats[ word ] + 1;
        } else {
            // `stats` does not yet have an entry for the current `word`.
              // As a result, let's add a new entry, and set count to 1.
            stats[ word ] = 1;
        }

        // Because we are building up `stats` over numerous iterations,
           //we need to return it for the next pass to modify it. //
        return stats;

    }, {})

    var word = [];
     // create an empty array
    // this for loop makes a dictionary for you
    for (i in counts){
    if (i!=='هر' && i!=='هم' && i !=='و'&& i !=='چه' && i !=='اما' && i !=='می‌کنند' && i !=='سایر' && i !=='همه' && i !=='رفته' && i !=='چنین' && i !=='آیا' && i !=='قرار' && i !=='کنیم' && i !=='که'&& i !=='به'&& i !=='نیز'&& i !=='این'&& i !=='ها'&& i !=='هایی'&& i !=='می'&& i !=='آن'&& i !=='باشد'&& i !=='بر'&& i !=='شد'&& i !=='اگر'&& i !=='آن'&& i !=='شده'&& i !=='ای'&& i !=='ندارد'&& i !=='شود'&& i !=='خود'&& i !=='کرد'&& i !=='پس'&& i !=='های'&& i !=='پس'&& i !=='پس'&& i !=='پس'){
    word.push({'text':i, "size": counts[i]});


    };

    };


console.log(word)

      d3.wordcloud()
        .size([800, 400])

        .fill(d3.scale.ordinal().range([ "#888", "#777", "#666", "#555", "#444", "#333", "#222"]))

        .words(word)
        .onwordclick(function(d, i) {
          if (d.href) { window.location = d.href; }
        })
        .start();
  console.log(counts);
  console.log(word);


    </script>
  </body>
</html>
